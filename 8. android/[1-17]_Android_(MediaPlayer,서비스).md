# [1/17] Android (MediaPlayer, 서비스)

## MediaPlayer 클래스 지원 함수

- prepare()
    - 메인 스레드에서 실행되는 함수
    - ANR(Application Not Responding, 앱 응답 없음) 을 유발할 수 있음
- prepareAsync()
    - 백그라운드 스레드에서 실행되는 함수
    - ANR 문제가 발생하지 않음

## 서비스

- 백그라운드에서 종료되지 않고 실행되는 안드로이드 4대 구성요소 중 하나
- 독립된 구성요소이기 때문에 독립된 생명 주기를 가짐
- 서비스를 앱에서 사용하려면 AndroidManifest.xml 에 직접 추가해야 함

### 시작된 서비스

- 한 번 시작된 서비스는 직접 종료하거나 다른 구성요소가 종료해야 서비스가 완전히 종료됨
- **다른 구성요소와 연결고리가 없음**
- startService() → onCreate() → onStartCommand() → (시작된 상태) → stopSelf()/StopService() → onDestroy() → (서비스 종료)

### 바인드된 서비스

- 바인드가 된 서비스는 다른 구성요소와 연결이 가능함
- 다른 앱의 구성요소가 서비스에 접근할 수 있도록 만들 수도 있음
- 바인드된 서비스는 기본적으로 다른 구성요소들에 바인드된 동안에만 실행됨
- **IBinder 라는 인터페이스를 매개로 다른 구성요소와 소통할 수 있음**
- bindService() → onCreate() → onBind() → (바인드된 상태) → unbindService() → onUnbind() → onDestroy() → (서비스 종료)

### 시작되고 바인드된 서비스

- 백그라운드에서 계속 남아있는 동시에 다른 구성요소와 연결되어 소통이 가능한 경우
- startService() 와 bindService() 두 함수 모두 실행
- startService() 함수로 시작된 상태가 된 서비스는 특별한 요청이 없는 한 바인드된 구성요소와 모든 연결이 끊겨도 계속 살아있음

### 포그라운드 서비스와 백그라운드 서비스

- 포그라운드 서비스 : 사용자가 서비스가 실행되고 있음을 능동적으로 인지할 수 있는 서비스
- 백그라운드 서비스 : 사용자가 보이지 않는 곳에서 조용히 작업 수행
- 만약 많은 앱이 백그라운드 서비스를 사용하고 사용자가 인지하지 못할 경우 기기에 성능 저하 발생할 수 있음
- 안드로이드 API 레벨 26(안드로이드 O) 부터는 포그라운드 서비스를 통해 상태 표시줄에 서비스가 실행되고 있음을 사용자에게 알려 높은 우선순위를 가지도록 함
- startForegroundService() 함수를 호출하고 나서는 서비스 생성 이후 5초 이내에 startForegroud() 함수를 통해 알림을 주어야 함
